<div class="container">
    <div class="header">
        <nav>
            <ul class="nav nav-pills pull-right">
                <li role="presentation"><a href="/users/$userId">My page</a></li>
            </ul>
        </nav>
        <a href="/index"><h3 class="text-muted">LIONBOARD</h3></a>
    </div>
    <div class="panel panel-default">
        <form id="post-form" method="post">
            <input type="hidden" name="userId" value="$userId"/>
            <div class="form-group">
                <label for="postTitle">제목</label>
                <input type="text" class="form-control" id="postTitle" name="title" placeholder="제목을 입력하세요.">
            </div>
            <textarea id="contents" name="contents" class="ckeditor" rows="12" cols="50"></textarea>
            <div class="form-group">
                <label for="postFile">파일 업로드</label>
                <input type="file" id="postFile" name="files">
            </div>
            <button type="submit" class="btn btn-default">저장</button>
    </div>
</div>

<script type="text/javascript" src="/js/jquery.min.js"></script>
<script type="text/javascript" src="http://cdn.jsdelivr.net/jquery.validation/1.14.0/jquery.validate.min.js"></script>
<script type="text/javascript" src="/js/bootstrap.min.js"></script>
<script type="text/javascript">
    $(document).ready(function(){

        $("#post-form").submit(function(){
            var postInfo = {
                title:$("input[name=title]").val(),
                contents:CKEDITOR.instances.contents.getData(),
                depth:0,
                userId:$("input[name=userId]").val(),
                existFiles:'F'
            };


            $.ajax({
                url: '/posts',
                type: 'post',
                data: postInfo,
                dataType: 'text',
                success: function (postId) {
                    window.location.replace("/posts/"+postId);
                }
            });

            return false;
        });
    });
</script>